!function(e,f,h,l){function c(a,b,d){if("boolean"===typeof a)return a;if("string"===typeof a){if("true"===a||"1"===a||a===d)return!0;if("false"===a||"0"===a||""===a)return!1}return b}var k=XF.autoFocusWithin,g=!1;XF.autoFocusWithin=function(a){if(!a.hasClass("menu--iconbox--focused"))return k.apply(this,arguments)};XF.IconBox=XF.Element.newHandler({menuInited:!1,menu:null,options:{icon:"| .input--icon",sampleBox:"| .js-iconbox-trigger",sample:"| .iconbox-sample-container"},init:function(){this.initOptions();
this.initDOM()},initOptions:function(){var a=this.$target;this.format=a.attr("data-format");this.inputName=a.attr("data-name");this.originalValue=JSON.parse(a.attr("data-value"));this.showColor="true"===a.attr("data-show-color");this.alwaysShowColor="true"===a.attr("data-always-show-color");this.canReset="true"===a.attr("data-can-reset");this.value="string"===typeof this.originalValue.value?IconifySearch.valueFromString(this.originalValue.value):"";this.color="string"===typeof this.originalValue.color?
this.originalValue.color:"";this.showColor&&(this.defaultColorResolved=a.attr("data-resolved-color"),this.defaultColor=this.color);this.readOnly=!1;this.required=c(this.originalValue.required,!1,"required");this.canTransform=c(this.originalValue.canTransform,!0);this.defaultValue="string"!==typeof this.originalValue["default"]?null:IconifySearch.valueFromString(this.originalValue["default"]);!this.canTransform&&this.value&&this.value.icon&&(this.value.rotate||this.value.hFlip||this.value.vFlip)&&
(this.canTransform=!0);this.required=c(a.attr("data-required"),this.required,"required");this.readOnly=c(a.attr("readonly"),this.readOnly,"readonly");this.readOnly=c(a.attr("data-readonly"),this.readOnly);this.canClear=this.required?!(null===this.defaultValue||!this.defaultValue.icon):!0;this.visibleIcon="";this.visibleIconPalette="unknown";h.addEventListener("IconifyAddedIcons",XF.proxy(this,"checkVisibleIconPalette"))},initDOM:function(){var a=this.$target;this.$hiddenValue=a.find(".iconbox-input--value");
this.showColor&&"object"===this.format&&(this.$hiddenColor=a.find(".iconbox-input--color"));this.$inputGroup=a.find(".inputGroup--iconbox");this.showColor&&(this.$color=a.find(".inputGroup--color > input"),this.$color.on("change",XF.proxy(this,"updateColorFromInput")),this.readOnly&&(this.$color.attr("readonly",!0),a.find(".inputGroup--color .inputGroup-text").addClass("inputGroup-text--disabled")));this.canReset&&(this.$reset=a.find(".inputChoices input[type=checkbox]"),this.$reset.prop("checked",
!1),"object"===this.format&&(this.$hiddenReset=a.find(".iconbox-input--reset")),this.$reset.on("change",XF.proxy(this,"updateHiddenInputs")));this.$icon=XF.findRelativeIf(this.options.icon,a);this.defaultValue&&this.$icon.attr("placeholder",this.defaultValue.icon);this.updateIconInput();this.readOnly||(this.$icon.on("blur paste",XF.proxy(this,"updateIconFromInput")),this.$icon.on("focus",XF.proxy(this,"iconInputFocus")));this.$sampleBox=XF.findRelativeIf(this.options.sampleBox,a);this.readOnly||this.$sampleBox.click(XF.proxy(this,
"iconSampleClick"));this.$sample=XF.findRelativeIf(this.options.sample,a);this.updateVisibleIcon()},updateHiddenInputs:function(){switch(this.format){case "string":var a=this.canTransform?IconifySearch.valueToClass(this.value):this.value.icon;this.$hiddenValue.val(a);this.$hiddenValue.trigger("change");break;case "json":a=Object.assign({},this.originalValue);a.value=this.value?IconifySearch.valueToClass(this.value):"";this.showColor&&(a.color=this.color);this.canReset&&this.$reset.prop("checked")&&
(a.reset=!0);this.$hiddenValue.val(JSON.stringify(a));this.$hiddenValue.trigger("change");break;case "object":this.$hiddenValue.val(this.value?IconifySearch.valueToClass(this.value):""),this.$hiddenValue.trigger("change"),this.showColor&&this.$hiddenColor&&(this.$hiddenColor.val(this.color),this.$hiddenColor.trigger("change")),this.canReset&&(this.$hiddenReset.val(this.$reset.prop("checked")?"true":""),this.$hiddenReset.trigger("change"))}},updateVisibleIcon:function(){if(this.value&&this.value.icon)var a=
this.value;else{if(!this.defaultValue||!this.defaultValue.icon){this.visibleIcon="";this.alwaysShowColor||this.$inputGroup.addClass("inputGroup--iconbox--empty");this.$sample.html('<span class="iconbox-sample iconbox-sample--empty"></span>');return}a=this.defaultValue}this.visibleIcon=a.icon;this.checkVisibleIconPalette(!0);this.alwaysShowColor||this.$inputGroup.removeClass("inputGroup--iconbox--empty");if(this.showColor){var b=this.color===this.defaultColor&&void 0!==this.defaultColorResolved?this.defaultColorResolved:
""!==this.color&&null!==(b=XF.Color.fromString(this.color))?b.toCss():"";var d="color: "+b+";";if(XF.Color&&(b=XF.Color.fromString(b),null!==b)){var c=b.toHsl();d+="background-color: "+(.6<c.l?"#000":"#fff")+";"}}this.$sample.html('<iconify-icon data-width="1em" data-height="1em" class="iconbox-sample '+IconifySearch.valueToClass(a)+'"'+(this.showColor&&""!==b?' style="'+d+'"':"")+"></iconify-icon>")},checkVisibleIconPalette:function(a){if(!0===a||"unknown"===this.visibleIconPalette){var b="unknown";
this.visibleIcon&&Iconify.iconExists(this.visibleIcon)&&(a=Iconify.getSVG(this.visibleIcon))&&(b=-1===a.indexOf("currentColor")?"colorful":"colorless");this.visibleIconPalette!==b&&(this.alwaysShowColor||(this.$inputGroup.removeClass("inputGroup--iconbox--"+this.visibleIconPalette),this.$inputGroup.addClass("inputGroup--iconbox--"+b),setTimeout(XF.layoutChange,0)),this.visibleIconPalette=b)}},updateIconInput:function(){this.$icon.val(IconifySearch.valueToClass(this.value).replace("icon:",""));this.$icon.trigger("change")},
updateIconFromInput:function(){var a=IconifySearch.valueFromString(this.$icon.val(),this.value);this.canClear||a&&a.icon?(this.canTransform||(a.rotate=0,a.hFlip=!1,a.vFlip=!1),JSON.stringify(a)!==JSON.stringify(this.value)&&(this.value=a,this.destroyMenu(),this.refreshIconValue("input"))):this.updateIconInput()},refreshIconValue:function(a){this.updateHiddenInputs();this.updateIconInput();this.updateVisibleIcon();"box"!==a&&this.updateIconPicker()},updateColorFromInput:function(){if(this.readOnly)this.$color.val(this.color);
else{this.color=this.$color.val();if("rgb("===this.color.slice(0,4)&&")"===this.color.slice(-1)){var a=this.color.slice(4,this.color.length-1);if(a.match(/^[0-9, ]+$/)&&(a=a.split(","),3===a.length)){var b="#";a.forEach(function(a){a=parseInt(a);b=isNaN(a)||null===b||0>a||255<a?null:b+((15>a?"0":"")+a.toString(16))});null!==b&&(this.color=b,this.$color.val(this.color))}}this.updateHiddenInputs();this.updateVisibleIcon()}},iconSampleClick:function(a){this.toggleMenu(a,!0)},iconInputFocus:function(a){this.toggleMenu(a,
!1)},toggleMenu:function(a,b){if(this.readOnly)this.menu&&this.closeMenu();else if(this.setupMenu(),b||!this.menu.isOpen())this.menu.$menu[b?"removeClass":"addClass"]("menu--iconbox--focused"),this.menu.toggle(XF.isEventTouchTriggered(a))},getOverlayParams:function(){var a={show:!0,overlay:!1,append:!1,fancySearch:!1,footer:{submit:!0,cancel:!0,clear:this.canClear},value:this.value,callback:this.iconifyCallback.bind(this)};this.canTransform&&(a.footer.transform=!0);return a},iconifyCallback:function(a,
b){switch(a){case "clear":if(!this.canClear)break;this.value=IconifySearch.emptyIcon();this.closeMenu();this.refreshIconValue("box");break;case "cancel":this.closeMenu();break;case "submit":this.value=b,this.closeMenu(),this.refreshIconValue("box")}},getMenuEl:function(){return e(e.parseHTML('<div class="menu menu--iconbox" data-menu="menu" aria-hidden="true"><div class="menu-content menu-content--iconbox"></div></div>'))},setupMenu:function(){g||(g=!0,void 0!==f.IconifySearchTranslation&&IconifySearch.setLang(f.IconifySearchTranslation));
if(!this.menuInited){this.menuInited=!0;var a=this.getMenuEl();this.$target.after(a);XF.activate(a);this.menuContentContainer=a.find(".menu-content--iconbox").get(0);IconifySearch.create(this.menuContentContainer,this.getOverlayParams());this.menu=new XF.MenuClick(this.$target,{menuPosRef:this.options.sampleBox,arrowPosRef:this.options.sampleBox});this.menu.$menuPosRef!==this.menu.$arrowPosRef&&(this.menu.$arrowPosRef=this.menu.$menuPosRef)}},openMenu:function(){this.readOnly||(this.setupMenu(),this.menu.open())},
closeMenu:function(){this.menu&&this.menu.close()},destroyMenu:function(){this.menuInited&&(this.closeMenu(),this.menuInited=!1,this.menu=null,this.menuContentContainer&&IconifySearch.destroy(this.menuContentContainer),this.menuContentContainer=null)},updateIconPicker:function(){this.menuContentContainer&&IconifySearch.create(this.menuContentContainer,this.getOverlayParams())}});XF.Element.register("iconbox","XF.IconBox")}(jQuery,window,document);